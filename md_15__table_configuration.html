<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>DirectOutput: Table configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="directoutputstyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DirectOutput_Small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirectOutput
   </div>
   <div id="projectbrief">DirectOutput framework for virtual pinball cabinets.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_15__table_configuration.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Table configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="tableconfig_intro"></a>
Introduction</h1>
<p>To make the <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> framework work, it is necessary that the framework gets information on the status changes of the elements (e.g. bumpers or lamps) on the pinball table. Depending on the type of table there a different ways how to achieve this.</p>
<p>If you modify a table to use the B2S.Server, the table will require the B2S.Server to be installed otherwise it will not run. Apart from the B2S.Server there are no requirements. Even if you add special commands for the <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> framework to the table script, the table will run without problemes if the framework is not installed.</p>
<h1><a class="anchor" id="tableconfig_VPSS"></a>
VP solid state (SS) tables</h1>
<h2><a class="anchor" id="tableconfig_VPSSconfig"></a>
Configure SS tables</h2>
<p>Visual Pinball solid state table are using PinMame for rom and game logic emulation. Therefore all data on changed table elements is anyway sent forth and back between PinMame and Visual Pinball. This makes the necessary changes to make <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> and also the B2S.Server work with the table very easy.</p>
<p>The only change required is to replace the statement instanciating the PinMame object:</p>
<p>Replace the following line</p>
<div class="fragment"><div class="line">Set Controller = CreateObject(<span class="stringliteral">&quot;VPinMAME.Controller&quot;</span>)     </div>
</div><!-- fragment --><p>with this modifed version</p>
<div class="fragment"><div class="line">Set Controller = CreateObject(<span class="stringliteral">&quot;B2S.Server&quot;</span>) </div>
</div><!-- fragment --><h2><a class="anchor" id="tableconfig_VPSSextend"></a>
Extend SS tables</h2>
<p>The config explained in the previous paragraph will usually be all you you to do to make a SS table work, but you have some more options.</p>
<p>If you want to tell the B2S.Server and the framework about events on the table which are not reported to PinMame, you can easily add some of the EM table commands of the B2S.Server to the table to send additionaly information to the B2S.Server.</p>
<p>This mix will work without any problem as long as the table is run in a environement which has the B2S.Server installed.</p>
<p>Please read the section <a class="el" href="md_15__table_configuration.html#tableconfig_VPEMscore">Table element status updates</a> for information on the EM table commands. The helpfile of the B2S Backglass Designer does also contain information on EM table commands.</p>
<h1><a class="anchor" id="tableconfig_VPEM"></a>
VP electro mechanical (EM) tables and original tables</h1>
<p>To make VP EM and original tables work with B2S.Server and <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a>, some more work is required.</p>
<p>Normally these table types dont send any information to the outside world and B2S.Server as well as <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> would never know about changed table element statuses. Therefore it is necessary to add some statements which will inform the B2S.Sever about the changes of table elements to the table script.</p>
<dl class="section note"><dt>Note</dt><dd>I recommend, that you also read the section on EM tables in the help file of the B2S Backglass Designer.</dd></dl>
<h2><a class="anchor" id="tableconfig_VPEMinit"></a>
Initialization</h2>
<p>At the beginning of the table script, usually after the Dim statements, the B2S.Server has to be instanciated and initialized. This is done with the following statements:</p>
<div class="fragment"><div class="line">Dim Controller</div>
<div class="line">Set Controller = CreateObject(<span class="stringliteral">&quot;B2S.Server&quot;</span>)</div>
<div class="line">Controller.B2SName = &quot;MyTable&quot;</div>
<div class="line">Controller.Run</div>
</div><!-- fragment --><p>The B2SName which is set in the third line of code is some kind of fake romname, which will be used by <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> to identify the table config in a LedControl file. Be sure to use a simple and unique name for the B2SName.</p>
<h2><a class="anchor" id="tableconfig_VPEMexit"></a>
Termination</h2>
<p>It is important that the B2S.Server and the <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> framework are informed, when the user exits the table. The following code will do this:</p>
<div class="fragment"><div class="line">Sub Table1_Exit</div>
<div class="line">    Controller.Stop</div>
<div class="line">End Sub</div>
</div><!-- fragment --><p>Before copying the code fragement to the table script, please check if the Table Exit section does already exist in the table. If it does, insert only the <em>Controller.Stop</em> statement.</p>
<dl class="section warning"><dt>Warning</dt><dd>If you dont add the <em>Controller.Stop</em> statement to the table exit code, you might experience performance problems or instability of your cabinet! Dont forget to add it!</dd></dl>
<h2><a class="anchor" id="tableconfig_VPEMscore"></a>
Table element status updates</h2>
<p>The B2S.Server has a bunch of special commands to forward information on the scores to the B2S.Server and the backglass. The <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> framework does also receive the values from these commands.</p>
<p>For a list and explanation of commands to set the scores, please read the section on EM tables in the helpfile of the B2S Backglass Deginer.</p>
<h2><a class="anchor" id="tableconfig_VPEMscore"></a>
Table element status updates</h2>
<p>Apart from initializing the most important thing for the <a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> framework is to receive updates on table element changes.</p>
<p>To send this information to the B2S.Server and the framework, you have to use the <em>B2SSetData</em> command of the B2S.Server. This commands accepts 2 parameters:</p>
<ul>
<li><em>ID</em> is the number of the table element changing its state or value. Just invent a numbering scheme of your choice for your table elements.</li>
<li><em>Value</em> is value or status of the table element.</li>
</ul>
<p>A complete <em>B2SSetData</em> statement might looks as follows: </p>
<div class="fragment"><div class="line">Controller.B2SSetData 123,1</div>
</div><!-- fragment --><p>Typically, the <em>B2SSetData</em> satement will be put into the event handlers of the table elements. For a switch you'll maybe end up with something like this:</p>
<div class="fragment"><div class="line">Sub sw5_Hit()</div>
<div class="line">    ... some other <span class="keyword">event</span> handling code ....</div>
<div class="line"></div>
<div class="line"> Controller.B2SSetData 205,1</div>
<div class="line">End Sub</div>
<div class="line"></div>
<div class="line">Sub sw5_UnHit()</div>
<div class="line">    ... some other <span class="keyword">event</span> handling code ....</div>
<div class="line">  Controller.B2SSetData 205,0</div>
<div class="line">End Sub</div>
</div><!-- fragment --><p>It is important, that you also send data to the B2S.Server when the table element reverts back to it original state (e.g. in the UnHit event of a switch). If you only use a single <em>B2SSetData</em> statement which always sends the same value for a element, the framework will not show any reaction, since the value does not change (<a class="el" href="namespace_direct_output.html" title="DirectOutput is the root namespace for this direct output library. ">DirectOutput</a> reacts on value changes and NOT on the fact that data is sent). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Jun 25 2013 10:49:13 for DirectOutput by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39987816-1']);
    _gaq.push(['_trackPageview']);
    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
</body>
</html>
