<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>DirectOutput: Installation and Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="directoutputstyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DirectOutput_Small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirectOutput
   </div>
   <div id="projectbrief">DirectOutput framework for virtual pinball cabinets.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('installation.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Installation and Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="installation_requirements"></a>
Requirements</h1>
<p>The Directoutput framework relies on the B2S-Server which has been developed by Herweh/Stefan. The B2S-Server implements a plugin interface which can load and execute plugins. This framework has been developed as such a plugin.</p>
<p>Therefore you must first install and configure Herwehs B2S-Server before you can install the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework. You can download the B2S-Server from <a href="http://vpuniverse.com/forums/files/file/2042-b2s-backglass-server/">vpuniverse.com</a> or <a href="http://www.vpforums.org/index.php?app=downloads&amp;showfile=7426">VPForums</a>.</p>
<h1><a class="anchor" id="installation_download"></a>
Download</h1>
<dl class="section note"><dt>Note</dt><dd>Sorry, public downloads are not yet available. As soon as the framework is released to the public, everyone will be allowed to download the framework.</dd></dl>
<p>The <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework can be downloaded from <a href="http://www.vpuniverse.com" target="_blank">vpuniverse.com</a>, but other sites might host the binaries as well.</p>
<p>You are also very welcome to fork/download and enhance the source code from <a href="https://github.com/DirectOutput/DirectOutput" target="_blank">GitHub</a>.</p>
<h1><a class="anchor" id="installation_installation"></a>
Installation</h1>
<p>Hosting applications which can use the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework, implement plugin interfaces which will automatically detect, load and use the library if it is correctly installed.</p>
<p>The <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework can be installed in two ways:</p>
<ul>
<li>Directly within the directory structure of the hosting application (e.g. B2S.Server). This will require only minimal effort when installing, but it might lead to duplicate installations if DOF is used in more than one hosting application.</li>
<li>In any other directory of your system. This will require a little more work during installation, because shortcuts from the hosting applications plugin directory to the directoy containg DOF have to be added. This installation pattern will all all applications which support DOF to use the same installation, so no duplicate installtions are required. This is the recommanded installtion pattern.</li>
</ul>
<h2><a class="anchor" id="installation_installation_hostappdir"></a>
Installation within hosting application directory structure</h2>
<p>To install DOF withing the directory structure of the application using the framework (e.g. B2S.Server), please do the following:</p>
<ul>
<li>In the installation directory of the hosting application, create a directoy called <em>plugins</em>.</li>
<li>Inside the newly created <em>plugins</em> directory, create a subdirectory called <em><a class="el" href="namespace_direct_output.html">DirectOutput</a></em> (any other name will be ok as well).</li>
<li>Unzip the contents of the zip-file containg the framework to the newly created <em><a class="el" href="namespace_direct_output.html">DirectOutput</a></em> directory.</li>
<li>If using platforms like Vista or Win7, the installed files might be blocked by UAC. To unblock the files please read: <a class="el" href="installation.html#installation_unblockauc">Unblock the DLLs</a></li>
</ul>
<p>If this has been done correctly, the hosting application will automatically detect, load and use the framework.</p>
<p><b>Example:</b> A typical installation of the framework for the B2S.Server (provided that B2S.Server is installed in the VP tables directory) will have to following directory and file structure:</p>
<div class="image">
<img src="Installation_DirectoryStructure.png" alt="Installation_DirectoryStructure.png"/>
<div class="caption">
Installation in hosting application directory structure</div></div>
<p> Note: Depending on the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework version, more files might exist in the installation.</p>
<h2><a class="anchor" id="installation_installation_owndir"></a>
Installation in own directory (Recommended)</h2>
<p>To avoid duplicate installations of the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework, the applications using the framework as a plugin can follow windows shortcuts to the directory containging DOF.</p>
<p>To install <a class="el" href="namespace_direct_output.html">DirectOutput</a> like this, please do the following:</p>
<ul>
<li>Create a directory for you <a class="el" href="namespace_direct_output.html">DirectOutput</a> installtion (e.g. C:\<a class="el" href="namespace_direct_output.html">DirectOutput</a>). The name and the path to this directory can be anything you like, but it might be a clever idea to have <a class="el" href="namespace_direct_output.html">DirectOutput</a> in the directory name.</li>
<li>Unzip the contents of the zip-file containg the framework to the newly created directory.</li>
<li>If using platforms like Vista or Win7, the installed files might be blocked by UAC. To unblock the files please read: <a class="el" href="installation.html#installation_unblockauc">Unblock the DLLs</a></li>
</ul>
<p>To allow the hosting application (e.g. B2S.Server) to detect the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework, do the following:</p>
<ul>
<li>Go to the directory containing the files of the hosting application (For B2S.Server this is typically the VP tables folder).</li>
<li>In this directory create a subdirectory named <em>plugins</em>.</li>
<li>In the newly created <em>plugins</em> directory, create a windows shortcut pointing to the directory containg the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework. This can be done by right clicking in the <em>plugins</em> directory and selecting New -&gt; Shortcut in the context menu.</li>
</ul>
<p><b>Example:</b> A typical installation of the framework in its own directory might resemble the following file and directory structure: </p>
<div class="image">
<img src="Installation_OwnDirectory1.png" alt="Installation_OwnDirectory1.png"/>
<div class="caption">
DirectOutput installtion in own directory</div></div>
<p> Note: Depending on the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework version, more files might exist in the installation.</p>
<p>If the framework is used with a B2S.Server installtion (which normaly reside in the VP table folder), you should have the following directory structure and shortcut (pointing to the directory containg the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework): </p>
<div class="image">
<img src="Installation_OwnDirectory2.png" alt="Installation_OwnDirectory2.png"/>
<div class="caption">
Shortcut pinting to the DirectOutput installation directory</div></div>
<h1><a class="anchor" id="installation_unblockauc"></a>
Unblock the DLLs</h1>
<p>On platforms like Win7 or Vista you might need to unblock the files of the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework, before it can be recognized by hosting applications (e.g. B2S.Server).</p>
<p>Please exceute the following procedure for all dll and exe files of the <a class="el" href="namespace_direct_output.html">DirectOutput</a> installtion:</p>
<ul>
<li>Right click the DLL file and select <em>Properties</em> in the context menu.</li>
<li>Select the <em>General</em> tab in the properties window.</li>
<li>If you find the text _"This file came from another computer and might be blocked to help protect this computer" or somthing similar on this tab, click the <em>Unblock</em> button. This should fix the issue.</li>
</ul>
<p>If the text about the file coming from another computer does not exist, everthing should be fine.</p>
<h1><a class="anchor" id="installation_b2sserverconfig"></a>
B2S.Server Configuration</h1>
<p>To enable the plugin support in the B2S.Server (<a class="el" href="namespace_direct_output.html">DirectOutput</a> is a B2S.Server plugin) you need to add the ArePluginsOn option to your B2STableSettings.xml file (In the Table directory). The result should resemble to following example: </p>
<div class="fragment"><div class="line">&lt;B2STableSettings&gt;</div>
<div class="line">  ....</div>
<div class="line">  &lt;ArePluginsOn&gt;1&lt;/ArePluginsOn&gt;</div>
<div class="line">  ...</div>
<div class="line">&lt;/B2STableSettings&gt;</div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>This block does not go to the end of the B2STableSettings.xml file. You really only have to put the line containing <em>ArePluginsOn</em> into the file.</dd></dl>
<h1><a class="anchor" id="installation_visualpinballcorevbs"></a>
Visual Pinball core.vbs Adjustment</h1>
<p>If you have used the <a href="http://www.hyperspin-fe.com/forum/showthread.php?10980-Tutorial-How-to-config-Ledwiz-PacDrive" target="_blank">VBScript solution</a> to control your LedWiz before you will have to <em>REMOVE</em> the line loading ledcontrol.vbs from your core.vbs.</p>
<p>Depending on your version of core.vbs this line might looks like one of the following two: </p>
<div class="fragment"><div class="line">ExecuteGlobal GetTextFile(<span class="stringliteral">&quot;ledcontrol.vbs&quot;</span>)</div>
</div><!-- fragment --><div class="fragment"><div class="line">LoadScript(<span class="stringliteral">&quot;ledcontrol.vbs&quot;</span>):Err.Clear    </div>
</div><!-- fragment --><p>If you dont remove the mentioned statement you'll run into trouble since the framework and the ledcontrol.vbs solutions will run simultaneously!</p>
<h1><a class="anchor" id="installation_tableconfig"></a>
Table Configuration</h1>
<p>Tables using the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework resp. the B2S-Server have to instanciate the B2S.Server instead of the Pinmame.Controller. Replace the following line in the table scripts of the tables you want to use the B2S.Server and the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework</p>
<div class="fragment"><div class="line">Set Controller = CreateObject(<span class="stringliteral">&quot;VPinMAME.Controller&quot;</span>)     </div>
</div><!-- fragment --><p>with</p>
<div class="fragment"><div class="line">Set Controller = CreateObject(<span class="stringliteral">&quot;B2S.Server&quot;</span>) </div>
</div><!-- fragment --><p>For EM tables it is also necessary to a some statements to send data about the table element statuses to <a class="el" href="namespace_direct_output.html">DirectOutput</a> and B2S.Server.</p>
<p>Please read the page on <a class="el" href="tableconfig.html">VP Table configuration</a> for more detailed information on this topic.</p>
<h1><a class="anchor" id="installation_configuration"></a>
Configuration</h1>
<p>The <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework supports several configuration options:</p>
<ul>
<li><b>Auto configuration</b> which tries to detect the connected hardware and the files containing the table definitions automatically. Auto configuration is using the legacy ledcontrol.ini file(s) for the table definitions if available.</li>
<li><b>XML config files</b> are the best way to configure the framework. They allow to configure every detail of the framework in detail.</li>
</ul>
<h2><a class="anchor" id="installation_autoconfiguration"></a>
Using Auto configuration</h2>
<p>If correctly installed the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework can configure itself automatically. This means that you dont need to create any of the config files mentioned in the sections below to get started.</p>
<p>Auto configuration will automatically detect the LedWiz units connected to your system and try to lookup the ledcontrol.ini file(s) with table configurations in the following locations:</p>
<ul>
<li>Table directory</li>
<li>Config directory of <a class="el" href="namespace_direct_output.html">DirectOutput</a></li>
<li>Directory containing the DirectOutput.dll</li>
</ul>
<p>Up to 16 LedWiz units are supported, which can be controlled by numbered ledcontrol.ini files. For LedWiz nr. 1 the file ledcontrol.ini will be loaded, for LedWiz numbers 2-16 files ledcontrol{LedWizNumber}.ini (e.g. ledcontrol2.ini) will be loaded.</p>
<p>To create your own lecontrol.ini files it is best to use the <a href="http://vpuniverse.com/ledwiz/login.php" target="_blank">LedWiz Config Tool</a>.</p>
<p>At the moment only LedWiz units are automatically detected. If you are using other output controllers you will have to create a cabinet configuration file, specifying the output controllers and some matching LedWizEquivalent toys, to allow the use of ledcontrol files.</p>
<h2><a class="anchor" id="installation_ledcontrolini"></a>
Using LedControl.ini files</h2>
<p>The <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework can use one or several classical LedControl.ini files to configure tables. If no other table config files are found, the framework will try to load the ledcontrol.ini file(s). By deafult the framework tries to find the ledcontrol files specified in the Global Config file. If global config does not specify ledcontrol file(s) the framework will search for ledcontrol file(s) in the following directories:</p>
<ul>
<li>Table directory</li>
<li>Config directory of <a class="el" href="namespace_direct_output.html">DirectOutput</a></li>
<li>Directory containing the DirectOutput.dll</li>
</ul>
<p>Please check the page on ledcontrolfiles for details.</p>
<h2><a class="anchor" id="installation_configfiles"></a>
Using configuration files</h2>
<p>The auto configuration function of the framework does only support some basic functionality of the framework. If you want to unleash the full power of <a class="el" href="namespace_direct_output.html">DirectOutput</a>, you can venture into the more detailed configuration options.</p>
<h3><a class="anchor" id="installation_globalconfig"></a>
Global Configuration</h3>
<p>The global configuration specifies some global settings for the framework, like the places where cabinet and table configurations are looked up.</p>
<p>If the framework is called through the B2S.Server Plugin it will search for a file named <em>GlobalConfiguration_b2SServer.xml</em> in the following places:</p>
<ul>
<li>A directory named <em>config</em> withing the directory of the DirectOutput.dll.</li>
<li>A shortcut named <em>config</em> to a directory.</li>
<li>Table directory.</li>
<li>Directory of the DirectOutput.dll.</li>
</ul>
<p>If no global configuration file can be found, the framework tries to configure itself by detecting LedWiz units and searching ledcontrol.ini file in the table directory, the config directory of the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework or the dll directory of the framework (see section on auto configuration above). In this mode, the framework behaves like the vbscript solution.</p>
<p>To create your own global configuration, you can either use the built in global configuration editor or write a XML-file with the necessary information yourself.</p>
<p>Please read the page on global config for a detailed explanation of the settings.</p>
<h3><a class="anchor" id="installation_cabinetconfig"></a>
Cabinet Configuration</h3>
<p>The cabinet configuration specifies the output controllers (e.g. Ledwiz) and toys (e.g. contactors and RGB leds) in your cabinet.</p>
<p>Typically the cabinet configuration file will be named cabinet.xml and reside in the config directory of the <a class="el" href="namespace_direct_output.html">DirectOutput</a> framework. Be sure to configure a file pattern in the global configuration pointing on your own cabinet configuration file.</p>
<p>Please read the page on <a class="el" href="cabinetconfig.html">Cabinet Configuration</a> for more information.</p>
<h3><a class="anchor" id="installation_tableconfig"></a>
Table Configuration</h3>
<p>The table configuration specifies the elements on a pinball table (e.g. solenoids or lamps) and the effects assigned to the table elements.</p>
<p>Please read the page on <a class="el" href="tableconfig.html">VP Table configuration</a> for details. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 14 2013 22:46:59 for DirectOutput by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39987816-1']);
    _gaq.push(['_trackPageview']);
    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
</body>
</html>
